"""
Network data fixtures for testing and development.
Provides sample devices, ports, links, and events.
"""

from datetime import datetime, timedelta
from typing import List, Dict, Any
import uuid


def generate_uuid() -> str:
    """Generate a UUID string."""
    return str(uuid.uuid4())


# Sample Devices
DEVICES: List[Dict[str, Any]] = [
    {
        "id": "dev-001",
        "name": "Core Router 1",
        "device_type": "ROUTER",
        "ip": "192.168.1.1",
        "mac": "00:1A:2B:3C:4D:01",
        "hostname": "core-router-01",
        "location": "Server Room A",
        "description": "Main core router for building A",
        "status": "UP",
        "last_seen": datetime.utcnow(),
        "is_monitored": True,
        "vlan_id": 1,
        "subnet": "192.168.1.0/24",
        "snmp_enabled": True,
        "snmp_community": "public",
        "snmp_version": "2c",
        "position_x": 400.0,
        "position_y": 100.0,
    },
    {
        "id": "dev-002",
        "name": "Core Switch 1",
        "device_type": "SWITCH",
        "ip": "192.168.1.2",
        "mac": "00:1A:2B:3C:4D:02",
        "hostname": "core-switch-01",
        "location": "Server Room A",
        "description": "Main distribution switch",
        "status": "UP",
        "last_seen": datetime.utcnow(),
        "is_monitored": True,
        "vlan_id": 1,
        "subnet": "192.168.1.0/24",
        "snmp_enabled": True,
        "snmp_community": "public",
        "snmp_version": "2c",
        "position_x": 400.0,
        "position_y": 250.0,
    },
    {
        "id": "dev-003",
        "name": "Access Switch 1",
        "device_type": "SWITCH",
        "ip": "192.168.1.10",
        "mac": "00:1A:2B:3C:4D:03",
        "hostname": "access-switch-01",
        "location": "Floor 1 - East Wing",
        "description": "Access layer switch for east wing",
        "status": "UP",
        "last_seen": datetime.utcnow(),
        "is_monitored": True,
        "vlan_id": 10,
        "subnet": "192.168.10.0/24",
        "snmp_enabled": True,
        "snmp_community": "public",
        "snmp_version": "2c",
        "position_x": 250.0,
        "position_y": 400.0,
    },
    {
        "id": "dev-004",
        "name": "Access Switch 2",
        "device_type": "SWITCH",
        "ip": "192.168.1.11",
        "mac": "00:1A:2B:3C:4D:04",
        "hostname": "access-switch-02",
        "location": "Floor 1 - West Wing",
        "description": "Access layer switch for west wing",
        "status": "UP",
        "last_seen": datetime.utcnow(),
        "is_monitored": True,
        "vlan_id": 20,
        "subnet": "192.168.20.0/24",
        "snmp_enabled": True,
        "snmp_community": "public",
        "snmp_version": "2c",
        "position_x": 550.0,
        "position_y": 400.0,
    },
    {
        "id": "dev-005",
        "name": "Server 1",
        "device_type": "SERVER",
        "ip": "192.168.1.50",
        "mac": "00:1A:2B:3C:4D:05",
        "hostname": "srv-01",
        "location": "Server Room A",
        "description": "Application server",
        "status": "UP",
        "last_seen": datetime.utcnow(),
        "is_monitored": True,
        "vlan_id": 1,
        "subnet": "192.168.1.0/24",
        "snmp_enabled": False,
        "position_x": 600.0,
        "position_y": 250.0,
    },
    {
        "id": "dev-006",
        "name": "Wireless AP 1",
        "device_type": "AP",
        "ip": "192.168.1.100",
        "mac": "00:1A:2B:3C:4D:06",
        "hostname": "ap-01",
        "location": "Floor 1 - Conference Room",
        "description": "Wireless access point",
        "status": "UP",
        "last_seen": datetime.utcnow(),
        "is_monitored": True,
        "vlan_id": 30,
        "subnet": "192.168.30.0/24",
        "snmp_enabled": True,
        "snmp_community": "public",
        "snmp_version": "2c",
        "position_x": 400.0,
        "position_y": 500.0,
    },
    {
        "id": "dev-007",
        "name": "Network Printer 1",
        "device_type": "PRINTER",
        "ip": "192.168.10.20",
        "mac": "00:1A:2B:3C:4D:07",
        "hostname": "printer-01",
        "location": "Floor 1 - East Wing",
        "description": "Department printer",
        "status": "UP",
        "last_seen": datetime.utcnow(),
        "is_monitored": True,
        "vlan_id": 10,
        "subnet": "192.168.10.0/24",
        "snmp_enabled": False,
        "position_x": 150.0,
        "position_y": 500.0,
    },
    {
        "id": "dev-008",
        "name": "Security Camera 1",
        "device_type": "CAMERA",
        "ip": "192.168.40.10",
        "mac": "00:1A:2B:3C:4D:08",
        "hostname": "cam-01",
        "location": "Floor 1 - Main Entrance",
        "description": "Security camera",
        "status": "UP",
        "last_seen": datetime.utcnow(),
        "is_monitored": True,
        "vlan_id": 40,
        "subnet": "192.168.40.0/24",
        "snmp_enabled": False,
        "position_x": 50.0,
        "position_y": 400.0,
    },
    {
        "id": "dev-009",
        "name": "Workstation PC 1",
        "device_type": "PC",
        "ip": "192.168.10.100",
        "mac": "00:1A:2B:3C:4D:09",
        "hostname": "ws-01",
        "location": "Floor 1 - East Wing - Desk 1",
        "description": "Employee workstation",
        "status": "UP",
        "last_seen": datetime.utcnow(),
        "is_monitored": False,
        "vlan_id": 10,
        "subnet": "192.168.10.0/24",
        "snmp_enabled": False,
        "position_x": 150.0,
        "position_y": 550.0,
    },
    {
        "id": "dev-010",
        "name": "Unknown Device",
        "device_type": "UNKNOWN",
        "ip": "192.168.1.199",
        "mac": "00:1A:2B:3C:4D:10",
        "hostname": None,
        "location": "Unknown",
        "description": "Unidentified network device",
        "status": "UNKNOWN",
        "last_seen": datetime.utcnow() - timedelta(hours=2),
        "is_monitored": False,
        "vlan_id": 1,
        "subnet": "192.168.1.0/24",
        "snmp_enabled": False,
        "position_x": 700.0,
        "position_y": 100.0,
    },
]


# Sample Ports
PORTS: List[Dict[str, Any]] = [
    # Core Router 1 Ports
    {
        "id": "port-001",
        "device_id": "dev-001",
        "name": "GigabitEthernet0/0",
        "port_number": 1,
        "port_name": "Gi0/0",
        "port_type": "ETHERNET",
        "status": "UP",
        "is_up": True,
        "speed_mbps": 1000.0,
        "max_speed_mbps": 1000.0,
        "mtu": 1500,
        "duplex": "Full",
        "vlan_id": 1,
        "is_trunk": True,
        "allowed_vlans": "1,10,20,30,40",
        "native_vlan": 1,
        "description": "Uplink to ISP",
    },
    {
        "id": "port-002",
        "device_id": "dev-001",
        "name": "GigabitEthernet0/1",
        "port_number": 2,
        "port_name": "Gi0/1",
        "port_type": "ETHERNET",
        "status": "UP",
        "is_up": True,
        "speed_mbps": 1000.0,
        "max_speed_mbps": 1000.0,
        "mtu": 1500,
        "duplex": "Full",
        "vlan_id": 1,
        "is_trunk": True,
        "allowed_vlans": "1,10,20,30,40",
        "native_vlan": 1,
        "description": "Link to Core Switch",
    },
    # Core Switch 1 Ports
    {
        "id": "port-003",
        "device_id": "dev-002",
        "name": "GigabitEthernet1/0/1",
        "port_number": 1,
        "port_name": "Gi1/0/1",
        "port_type": "ETHERNET",
        "status": "UP",
        "is_up": True,
        "speed_mbps": 1000.0,
        "max_speed_mbps": 1000.0,
        "mtu": 1500,
        "duplex": "Full",
        "vlan_id": 1,
        "is_trunk": True,
        "allowed_vlans": "1,10,20,30,40",
        "native_vlan": 1,
        "description": "Link to Core Router",
    },
    {
        "id": "port-004",
        "device_id": "dev-002",
        "name": "GigabitEthernet1/0/2",
        "port_number": 2,
        "port_name": "Gi1/0/2",
        "port_type": "ETHERNET",
        "status": "UP",
        "is_up": True,
        "speed_mbps": 1000.0,
        "max_speed_mbps": 1000.0,
        "mtu": 1500,
        "duplex": "Full",
        "vlan_id": 10,
        "is_trunk": False,
        "description": "Link to Access Switch 1",
    },
    {
        "id": "port-005",
        "device_id": "dev-002",
        "name": "GigabitEthernet1/0/3",
        "port_number": 3,
        "port_name": "Gi1/0/3",
        "port_type": "ETHERNET",
        "status": "UP",
        "is_up": True,
        "speed_mbps": 1000.0,
        "max_speed_mbps": 1000.0,
        "mtu": 1500,
        "duplex": "Full",
        "vlan_id": 20,
        "is_trunk": False,
        "description": "Link to Access Switch 2",
    },
    {
        "id": "port-006",
        "device_id": "dev-002",
        "name": "GigabitEthernet1/0/24",
        "port_number": 24,
        "port_name": "Gi1/0/24",
        "port_type": "ETHERNET",
        "status": "UP",
        "is_up": True,
        "speed_mbps": 1000.0,
        "max_speed_mbps": 1000.0,
        "mtu": 1500,
        "duplex": "Full",
        "vlan_id": 1,
        "is_trunk": False,
        "description": "Link to Server 1",
    },
    # Access Switch 1 Ports
    {
        "id": "port-007",
        "device_id": "dev-003",
        "name": "FastEthernet0/1",
        "port_number": 1,
        "port_name": "Fa0/1",
        "port_type": "ETHERNET",
        "status": "UP",
        "is_up": True,
        "speed_mbps": 1000.0,
        "max_speed_mbps": 1000.0,
        "mtu": 1500,
        "duplex": "Full",
        "vlan_id": 10,
        "is_trunk": False,
        "description": "Uplink to Core Switch",
    },
    {
        "id": "port-008",
        "device_id": "dev-003",
        "name": "FastEthernet0/5",
        "port_number": 5,
        "port_name": "Fa0/5",
        "port_type": "ETHERNET",
        "status": "UP",
        "is_up": True,
        "speed_mbps": 100.0,
        "max_speed_mbps": 1000.0,
        "mtu": 1500,
        "duplex": "Full",
        "vlan_id": 10,
        "is_trunk": False,
        "description": "Printer connection",
    },
    {
        "id": "port-009",
        "device_id": "dev-003",
        "name": "FastEthernet0/10",
        "port_number": 10,
        "port_name": "Fa0/10",
        "port_type": "ETHERNET",
        "status": "UP",
        "is_up": True,
        "speed_mbps": 1000.0,
        "max_speed_mbps": 1000.0,
        "mtu": 1500,
        "duplex": "Full",
        "vlan_id": 10,
        "is_trunk": False,
        "description": "Workstation connection",
    },
    # Access Switch 2 Ports
    {
        "id": "port-010",
        "device_id": "dev-004",
        "name": "FastEthernet0/1",
        "port_number": 1,
        "port_name": "Fa0/1",
        "port_type": "ETHERNET",
        "status": "UP",
        "is_up": True,
        "speed_mbps": 1000.0,
        "max_speed_mbps": 1000.0,
        "mtu": 1500,
        "duplex": "Full",
        "vlan_id": 20,
        "is_trunk": False,
        "description": "Uplink to Core Switch",
    },
    {
        "id": "port-011",
        "device_id": "dev-004",
        "name": "FastEthernet0/12",
        "port_number": 12,
        "port_name": "Fa0/12",
        "port_type": "ETHERNET",
        "status": "DOWN",
        "is_up": False,
        "speed_mbps": 0.0,
        "max_speed_mbps": 1000.0,
        "mtu": 1500,
        "duplex": None,
        "vlan_id": 20,
        "is_trunk": False,
        "description": "Unused port",
    },
]


# Sample Links
LINKS: List[Dict[str, Any]] = [
    {
        "id": "link-001",
        "source_device_id": "dev-001",
        "target_device_id": "dev-002",
        "source_port_id": "port-002",
        "target_port_id": "port-003",
        "link_type": "PHYSICAL",
        "status": "UP",
        "bandwidth": 1000,
        "speed_mbps": 1000.0,
        "duplex": "Full",
        "utilization": 45.5,
        "packet_loss": 0.01,
        "latency": 0.5,
        "jitter": 0.1,
        "cost": 10,
        "description": "Core Router to Core Switch",
    },
    {
        "id": "link-002",
        "source_device_id": "dev-002",
        "target_device_id": "dev-003",
        "source_port_id": "port-004",
        "target_port_id": "port-007",
        "link_type": "PHYSICAL",
        "status": "UP",
        "bandwidth": 1000,
        "speed_mbps": 1000.0,
        "duplex": "Full",
        "utilization": 30.2,
        "packet_loss": 0.02,
        "latency": 1.2,
        "jitter": 0.3,
        "cost": 20,
        "description": "Core Switch to Access Switch 1",
    },
    {
        "id": "link-003",
        "source_device_id": "dev-002",
        "target_device_id": "dev-004",
        "source_port_id": "port-005",
        "target_port_id": "port-010",
        "link_type": "PHYSICAL",
        "status": "UP",
        "bandwidth": 1000,
        "speed_mbps": 1000.0,
        "duplex": "Full",
        "utilization": 25.8,
        "packet_loss": 0.01,
        "latency": 1.0,
        "jitter": 0.2,
        "cost": 20,
        "description": "Core Switch to Access Switch 2",
    },
    {
        "id": "link-004",
        "source_device_id": "dev-002",
        "target_device_id": "dev-005",
        "source_port_id": "port-006",
        "target_port_id": None,
        "link_type": "PHYSICAL",
        "status": "UP",
        "bandwidth": 1000,
        "speed_mbps": 1000.0,
        "duplex": "Full",
        "utilization": 65.3,
        "packet_loss": 0.0,
        "latency": 0.3,
        "jitter": 0.05,
        "cost": 10,
        "description": "Core Switch to Server 1",
    },
    {
        "id": "link-005",
        "source_device_id": "dev-003",
        "target_device_id": "dev-007",
        "source_port_id": "port-008",
        "target_port_id": None,
        "link_type": "PHYSICAL",
        "status": "UP",
        "bandwidth": 100,
        "speed_mbps": 100.0,
        "duplex": "Full",
        "utilization": 5.5,
        "packet_loss": 0.0,
        "latency": 2.0,
        "jitter": 0.5,
        "cost": 50,
        "description": "Access Switch 1 to Printer 1",
    },
    {
        "id": "link-006",
        "source_device_id": "dev-003",
        "target_device_id": "dev-009",
        "source_port_id": "port-009",
        "target_port_id": None,
        "link_type": "PHYSICAL",
        "status": "UP",
        "bandwidth": 1000,
        "speed_mbps": 1000.0,
        "duplex": "Full",
        "utilization": 15.0,
        "packet_loss": 0.0,
        "latency": 1.5,
        "jitter": 0.3,
        "cost": 30,
        "description": "Access Switch 1 to Workstation 1",
    },
]


# Sample Cable Health Metrics
CABLE_HEALTH: List[Dict[str, Any]] = [
    {
        "id": "health-001",
        "link_id": "link-001",
        "cable_type": "CAT6A",
        "status": "EXCELLENT",
        "length": 15.5,
        "signal_strength": -45.0,
        "signal_quality": 98,
        "noise_level": -85.0,
        "snr": 40.0,
        "attenuation": 2.5,
        "impedance": 100.0,
        "latency_ms": 0.5,
        "packet_loss_percent": 0.01,
        "jitter_ms": 0.1,
        "bit_error_rate": 0.0000001,
        "error_count": 0,
        "discard_count": 0,
        "crc_errors": 0,
        "pair1_status": "OK",
        "pair2_status": "OK",
        "pair3_status": "OK",
        "pair4_status": "OK",
        "health_score": 98.5,
        "notes": "Cable in excellent condition",
    },
    {
        "id": "health-002",
        "link_id": "link-002",
        "cable_type": "CAT6",
        "status": "GOOD",
        "length": 45.0,
        "signal_strength": -52.0,
        "signal_quality": 92,
        "noise_level": -80.0,
        "snr": 28.0,
        "attenuation": 5.2,
        "impedance": 100.0,
        "latency_ms": 1.2,
        "packet_loss_percent": 0.02,
        "jitter_ms": 0.3,
        "bit_error_rate": 0.0000005,
        "error_count": 2,
        "discard_count": 0,
        "crc_errors": 1,
        "pair1_status": "OK",
        "pair2_status": "OK",
        "pair3_status": "OK",
        "pair4_status": "OK",
        "health_score": 92.0,
        "notes": "Cable performing well",
    },
    {
        "id": "health-003",
        "link_id": "link-003",
        "cable_type": "CAT6",
        "status": "FAIR",
        "length": 55.0,
        "signal_strength": -58.0,
        "signal_quality": 85,
        "noise_level": -75.0,
        "snr": 17.0,
        "attenuation": 8.5,
        "impedance": 102.0,
        "latency_ms": 1.8,
        "packet_loss_percent": 0.05,
        "jitter_ms": 0.5,
        "bit_error_rate": 0.000002,
        "error_count": 12,
        "discard_count": 3,
        "crc_errors": 8,
        "pair1_status": "OK",
        "pair2_status": "OK",
        "pair3_status": "DEGRADED",
        "pair4_status": "OK",
        "health_score": 78.5,
        "notes": "Pair 3 showing degradation, recommend inspection",
    },
]


# Sample Events
EVENTS: List[Dict[str, Any]] = [
    {
        "id": "event-001",
        "event_type": "DEVICE_UP",
        "severity": "INFO",
        "device_id": "dev-001",
        "port_id": None,
        "link_id": None,
        "message": "Core Router 1 is now online",
        "details": {"previous_status": "UNKNOWN", "new_status": "UP"},
        "source": "monitoring_service",
        "acknowledged": True,
        "acknowledged_by": "admin",
        "acknowledged_at": datetime.utcnow() - timedelta(hours=1),
        "notes": "Device came back online after maintenance",
        "created_at": datetime.utcnow() - timedelta(hours=2),
    },
    {
        "id": "event-002",
        "event_type": "PORT_DOWN",
        "severity": "MEDIUM",
        "device_id": "dev-004",
        "port_id": "port-011",
        "link_id": None,
        "message": "Port Fa0/12 on Access Switch 2 is down",
        "details": {"port_name": "Fa0/12", "previous_status": "UP"},
        "source": "snmp_monitor",
        "acknowledged": False,
        "acknowledged_by": None,
        "acknowledged_at": None,
        "notes": None,
        "created_at": datetime.utcnow() - timedelta(minutes=30),
    },
    {
        "id": "event-003",
        "event_type": "HIGH_LATENCY",
        "severity": "HIGH",
        "device_id": None,
        "port_id": None,
        "link_id": "link-003",
        "message": "High latency detected on link between Core Switch and Access Switch 2",
        "details": {"current_latency": 15.5, "threshold": 5.0, "unit": "ms"},
        "source": "performance_monitor",
        "acknowledged": False,
        "acknowledged_by": None,
        "acknowledged_at": None,
        "notes": None,
        "created_at": datetime.utcnow() - timedelta(minutes=15),
    },
    {
        "id": "event-004",
        "event_type": "DEVICE_DISCOVERED",
        "severity": "INFO",
        "device_id": "dev-010",
        "port_id": None,
        "link_id": None,
        "message": "New unknown device discovered on network",
        "details": {"ip": "192.168.1.199", "mac": "00:1A:2B:3C:4D:10"},
        "source": "network_scanner",
        "acknowledged": False,
        "acknowledged_by": None,
        "acknowledged_at": None,
        "notes": None,
        "created_at": datetime.utcnow() - timedelta(hours=5),
    },
    {
        "id": "event-005",
        "event_type": "CABLE_HEALTH_DEGRADED",
        "severity": "MEDIUM",
        "device_id": None,
        "port_id": None,
        "link_id": "link-003",
        "message": "Cable health degraded on link to Access Switch 2",
        "details": {
            "health_score": 78.5,
            "previous_score": 92.0,
            "degraded_pair": "pair3"
        },
        "source": "cable_health_monitor",
        "acknowledged": False,
        "acknowledged_by": None,
        "acknowledged_at": None,
        "notes": None,
        "created_at": datetime.utcnow() - timedelta(minutes=45),
    },
    {
        "id": "event-006",
        "event_type": "SCAN_COMPLETED",
        "severity": "INFO",
        "device_id": None,
        "port_id": None,
        "link_id": None,
        "message": "Network scan completed successfully",
        "details": {
            "devices_found": 10,
            "new_devices": 1,
            "scan_duration": 120.5,
            "scan_range": "192.168.0.0/16"
        },
        "source": "network_scanner",
        "acknowledged": True,
        "acknowledged_by": "admin",
        "acknowledged_at": datetime.utcnow() - timedelta(minutes=10),
        "notes": "Regular scheduled scan",
        "created_at": datetime.utcnow() - timedelta(hours=1),
    },
]


# Helper function to get all fixture data
def get_all_fixtures() -> Dict[str, List[Dict[str, Any]]]:
    """
    Get all fixture data organized by type.
    
    Returns:
        Dictionary with fixture data for devices, ports, links, cable_health, and events
    """
    return {
        "devices": DEVICES,
        "ports": PORTS,
        "links": LINKS,
        "cable_health": CABLE_HEALTH,
        "events": EVENTS,
    }


# Helper function to get fixtures by type
def get_fixtures(fixture_type: str) -> List[Dict[str, Any]]:
    """
    Get fixtures of a specific type.
    
    Args:
        fixture_type: Type of fixture (devices, ports, links, cable_health, events)
        
    Returns:
        List of fixture dictionaries
    """
    fixtures = get_all_fixtures()
    return fixtures.get(fixture_type, [])


if __name__ == "__main__":
    # Print summary when run directly
    print("Network Data Fixtures Summary:")
    print(f"Devices: {len(DEVICES)}")
    print(f"Ports: {len(PORTS)}")
    print(f"Links: {len(LINKS)}")
    print(f"Cable Health Metrics: {len(CABLE_HEALTH)}")
    print(f"Events: {len(EVENTS)}")
    
    print("\nDevice Types:")
    device_types = {}
    for device in DEVICES:
        dt = device["device_type"]
        device_types[dt] = device_types.get(dt, 0) + 1
    for dt, count in device_types.items():
        print(f"  {dt}: {count}")