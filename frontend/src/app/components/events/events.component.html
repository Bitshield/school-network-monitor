<div class="events-container">
  <!-- Header -->
  <div class="events-header">
    <div class="header-left">
      <h1>Events & Alerts</h1>
      <span class="event-count">{{ totalEvents }} events</span>
    </div>
    
    <div class="header-right">
      <button 
        class="btn btn-primary" 
        *ngIf="selectedEvents.length > 0"
        (click)="bulkAcknowledge()">
        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        Acknowledge Selected ({{ selectedEvents.length }})
      </button>
      
      <button class="btn btn-secondary" (click)="loadEvents()">
        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
        </svg>
        Refresh
      </button>
    </div>
  </div>
  
  <!-- Filters -->
  <div class="filters-panel">
    <div class="filter-group">
      <select [(ngModel)]="selectedSeverity" (change)="onFilterChange()" class="filter-select">
        <option value="">All Severities</option>
        <option *ngFor="let severity of eventSeverities" [value]="severity">{{ severity }}</option>
      </select>
      
      <select [(ngModel)]="selectedType" (change)="onFilterChange()" class="filter-select">
        <option value="">All Types</option>
        <option *ngFor="let type of eventTypes" [value]="type">{{ type.replace('_', ' ') }}</option>
      </select>
      
      <label class="checkbox-filter">
        <input type="checkbox" [(ngModel)]="showUnacknowledgedOnly" (change)="onFilterChange()" />
        <span>Unacknowledged only</span>
      </label>
      
      <label class="checkbox-filter">
        <input type="checkbox" [(ngModel)]="showAcknowledgedOnly" (change)="onFilterChange()" />
        <span>Acknowledged only</span>
      </label>
    </div>
  </div>
  
  <!-- Loading State -->
  <div class="loading-state" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Loading events...</p>
  </div>
  
  <!-- Events List -->
  <div class="events-list" *ngIf="!isLoading">
    <div class="event-card" *ngFor="let event of events" [class.selected]="selectedEvents.includes(event.id)">
      <div class="event-checkbox">
        <input 
          type="checkbox" 
          [checked]="selectedEvents.includes(event.id)"
          (change)="toggleEventSelection(event.id)"
        />
      </div>
      
      <div class="event-icon" [class]="getSeverityClass(event.severity)">
        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
        </svg>
      </div>
      
      <div class="event-content">
        <div class="event-header-row">
          <div class="event-title">{{ event.title }}</div>
          <span class="severity-badge" [class]="getSeverityClass(event.severity)">
            {{ event.severity }}
          </span>
        </div>
        
        <div class="event-message">{{ event.message }}</div>
        
        <div class="event-meta">
          <span class="event-type">{{ event.event_type.replace('_', ' ') }}</span>
          <span class="event-time">{{ formatTimestamp(event.created_at) }}</span>
          <span *ngIf="event.device_id" class="event-device">
            <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                    d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
            Device Event
          </span>
          <span *ngIf="event.link_id" class="event-link">
            <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                    d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
            </svg>
            Link Event
          </span>
        </div>
        
        <div class="event-status" *ngIf="event.acknowledged || event.resolved">
          <span class="status-item acknowledged" *ngIf="event.acknowledged">
            <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            Acknowledged by {{ event.acknowledged_by || 'User' }}
            <span class="status-time" *ngIf="event.acknowledged_at">
  {{ formatTimestamp(event.acknowledged_at) }}
</span>

          </span>
          
         <span class="status-item resolved" *ngIf="event.resolved">
  <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
          d="M5 13l4 4L19 7" />
  </svg>
  Resolved by {{ event.resolved_by || 'User' }}
  <span class="status-time" *ngIf="event.resolved_at">
    {{ formatTimestamp(event.resolved_at) }}
  </span>
</span>

        </div>
      </div>
      
      <div class="event-actions">
        <button 
          class="btn btn-sm btn-acknowledge" 
          *ngIf="!event.acknowledged"
          (click)="acknowledgeEvent(event)">
          <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                  d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          Acknowledge
        </button>
        
        <span class="acknowledged-label" *ngIf="event.acknowledged">
          âœ“ Acknowledged
        </span>
      </div>
    </div>
    
    <!-- Empty State -->
    <div class="empty-state" *ngIf="events.length === 0">
      <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
              d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
      </svg>
      <p>No events found</p>
    </div>
  </div>
  
  <!-- Pagination -->
  <div class="pagination" *ngIf="!isLoading && events.length > 0">
    <button class="btn btn-pagination" (click)="previousPage()" [disabled]="currentPage === 1">
      <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
      Previous
    </button>
    
    <div class="page-info">
      Page {{ currentPage }} of {{ totalPages }}
    </div>
    
    <button class="btn btn-pagination" (click)="nextPage()" [disabled]="currentPage >= totalPages">
      Next
      <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </button>
  </div>
</div>